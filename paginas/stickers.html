<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/stilo.css"> <!--css externo-->
    <link rel="icon" href="../imgs/santinho.png"> <!--icon do site-->
    <title>Arcane Boot&reg_Stickers</title>
</head>

<body>
    <header>
        <img src="../imgs/Logo_lisas_c-removebg-preview.png" alt="Logo ArcaneBoot">
        <nav id="menu">
            <ul>
                <li><a href="../index.html">Inicio</a></li>
            </ul>
        </nav>
    </header>

    <main id="conteudo">
        <section>
            <div class="carrosel-galeria-videos">
                <button class="btn prev">&#10094;</button>
                <div class="slides">
                    <div class="video"><video src="../imgs/nintendo-v2.mp4" muted playsinline preload="metadata"
                            controls></video><br>
                        <h4>Video curta</h4>
                    </div>
                    <div class="video"><video src="../imgs/feteps-video.mp4" muted playsinline preload="metadata"
                            controls></video>
                        <h4>Pitch</h4>
                    </div>
                    <div class="video"><video src="../imgs/game-santiago.mp4" muted playsinline preload="metadata"
                            controls></video>
                        <h4>Animação das sprites</h4>
                    </div>
                </div>
                <button class="btn next">&#10095;</button>
            </div><br>

            <div class="stikers">
                <div class="item"><img src="../imgs/santiago-jogo.jpeg" alt="sprites do santiago"></div>
                <div class="item"><img src="../imgs/santiago-jogo2.jpeg" alt="sprites do santiago"></div>
                <div class="item"><img src="../imgs/Penélope uaiv3.gif" alt="Penelope gif"></div>
                <div class="item"><img src="../imgs/cabeca_penelope_santiago.png"
                        alt="miniaturas de santiago e penelope"></div>
                <div class="item"><img src="../imgs/santinho-v2.png" alt="Santiago em pixel"></div>
                <div class="item"><img src="../imgs/Penelope.png" alt="Penelope"></div>
                <div class="item"><img src="../imgs/capa-ab.jpeg" alt="capa ArcaneBoot"></div>
                <div class="item"><img src="../imgs/logo_GM(1).png" alt="Logo do projeto"></div>
                <div class="item"><img src="../imgs/capa-gm.jpeg" alt="capa GoldenMaker"></div>
                <div class="item"><img src="../imgs/quarto-img.jpeg" alt=""></div>
                <div class="item"><img src="../imgs/santiago-v1.png" alt="Santiago em pixel"></div>
                <div class="item"><img src="../imgs/Logo-gm1.png" alt="Logo do projeto"></div>
                <!-- ... -->
            </div>
        </section>
    </main>

    <footer id="roda_pe">
        <div>
            <h2>ARCANE <img src="../imgs/flor1.png" alt="flor de lis"> BOOT</h2>
            <h5>adventure stars here</h5>
        </div><br>
        <div class="contatos">
            <h2>Contatos:</h2><br>
            <div id="contatos">
                <div id="contatos-github">
                    <img src="../imgs/github.png" alt="logo github">
                    <a href="https://github.com/sweet-aludra">sweet-aludra (Adryelle)</a>
                    <a href="https://github.com/Belanquinha">Belanquinha (Gabriel)</a>
                    <a href="https://github.com/luiz684">luiz684 (Luiz)</a>
                    <a href="https://github.com/WKDavi">WKDavi (Thiago)</a>
                </div>
                <div id="contatos-instagram">
                    <img src="../imgs/intagram.png" alt="logo instagram">
                    <a href="https://github.com/sweet-aludra">sweet-aludra (Adryelle)</a>
                    <a href="https://github.com/Belanquinha">Belanquinha (Gabriel)</a>
                    <a href="https://github.com/luiz684">luiz684 (Luiz)</a>
                    <a href="https://github.com/WKDavi">WKDavi (Thiago)</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        document.querySelectorAll(".carrosel-galeria-videos").forEach(carrosel => {
            const slides = carrosel.querySelector(".slides");
            if (!slides) return;

            const itens = slides.children;
            if (!itens || itens.length === 0) return;

            const prev = carrosel.querySelector(".prev");
            const next = carrosel.querySelector(".next");

            let index = 0;
            let itemWidth = 0;
            const GAP = 20;

            function calcItemWidth() {
                if (itens.length === 0) return 0;
                const rect = itens[0].getBoundingClientRect();
                itemWidth = Math.round(rect.width) + GAP;
            }

            function updateCarousel(animate = true) {
                if (!itemWidth) calcItemWidth();
                if (!itemWidth) return;

                slides.style.transition = animate ? "" : "none";
                slides.style.transform = `translateX(${-index * itemWidth}px)`;

                if (!animate) slides.getBoundingClientRect();

                playVisibleVideo();

                if (!animate) slides.style.transition = "";
            }

            // botões
            if (prev) {
                prev.addEventListener("click", () => {
                    index--;
                    if (index < 0) index = itens.length - 1;
                    updateCarousel();
                });
            }

            if (next) {
                next.addEventListener("click", () => {
                    index++;
                    if (index >= itens.length) index = 0;
                    updateCarousel();
                });
            }

            // lista de vídeos
            const videos = slides.querySelectorAll("video");

            // tocar só o vídeo visível
            function playVisibleVideo() {
                videos.forEach((v, i) => {
                    if (i === index) {
                        v.muted = true;
                        v.playsInline = true;
                        v.play().catch(() => { });
                    } else {
                        try { v.pause(); } catch (e) { }
                        v.currentTime = 0;
                    }
                });
            }

            // SE O VÍDEO TERMINAR → AVANÇA PARA O PRÓXIMO SLIDE 
            /*videos.forEach((v, i) => {
                v.addEventListener("ended", () => {
                    index++;
                    if (index >= itens.length) index = 0;
                    updateCarousel();
                });
            });*/

            // recalcular no resize
            window.addEventListener("resize", () => {
                calcItemWidth();
                updateCarousel(false);
            });

            // garantir que calcule tamanho após carregar metadados
            if (videos.length > 0) {
                let loaded = 0;
                videos.forEach(v => {
                    if (v.readyState >= 1) {
                        loaded++;
                    } else {
                        v.addEventListener("loadedmetadata", () => {
                            loaded++;
                            if (loaded === videos.length) {
                                calcItemWidth();
                                updateCarousel(false);
                            }
                        }, { once: true });
                    }
                });

                if (loaded === videos.length) {
                    calcItemWidth();
                    updateCarousel(false);
                }
            } else {
                calcItemWidth();
                updateCarousel(false);
            }

            // permitir que o usuário ligue o som clicando
            carrosel.addEventListener("click", () => {
                const v = videos[index];
                if (v) v.muted = false;
            });
        });
    </script>



</body>

</html>